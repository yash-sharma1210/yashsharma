<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>CampusCare â€” Student Well-Being (Expanded)</title>
<!-- Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&amp;family=Baloo+2:wght@400;600&amp;display=swap" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
<!-- =====================================
       Large CSS â€” expanded, many rules
       (no pink, soothing palette, animations)
       ===================================== -->
<style>
    /* ============================
       Root palette (no pink anywhere)
       ============================ */
    :root{
      --bg1: #eaf6ff;
      --bg2: #f3fff7;
      --card: #ffffff;
      --glass: rgba(255,255,255,0.78);
      --primary: #2b7cff;
      --primary-700: #1e5bd6;
      --accent: #6ce7c7;
      --sun: #ffd166;
      --violet: #8f78ff;
      --muted: #4a5568;
      --dark: #0b2545;
      --shadow-1: 0 8px 32px rgba(11,37,69,0.08);
      --shadow-2: 0 18px 60px rgba(10,30,80,0.10);
      --radius-lg: 18px;
      --radius-md: 12px;
      --glass-border: 1px solid rgba(255,255,255,0.6);
      --max-width: 1200px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;
    }

    /* ---------- Reset & base ---------- */
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:"Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(135deg, var(--bg1) 0%, #f7fbff 35%, var(--bg2) 100%);
      color: var(--dark);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding-bottom:140px; /* room for footer fixed effects */
      overflow-x:hidden;
    }
    a{color:inherit;text-decoration:none}
    button{font-family:inherit}

    /* ---------- Decorative background shapes ---------- */
    .bg-shape{position:fixed;border-radius:50%;filter: blur(28px);opacity:0.18;pointer-events:none;z-index:0;transform:translateZ(0)}
    .bg-shape.one{width:480px;height:480px;left:-140px;top:-100px;background:linear-gradient(120deg,var(--primary),var(--violet));animation:floatA 22s linear infinite}
    .bg-shape.two{width:360px;height:360px;right:-120px;bottom:-80px;background:linear-gradient(120deg,var(--accent),var(--sun));animation:floatB 18s linear infinite}
    .bg-shape.three{width:180px;height:180px;left:36%;top:6%;background:linear-gradient(120deg,#c6f4e2,#dfe9ff);animation:floatC 26s linear infinite}
    @keyframes floatA{0%{transform:translateY(0)}50%{transform:translateY(-30px) rotate(90deg)}100%{transform:translateY(0) rotate(360deg)}}
    @keyframes floatB{0%{transform:translateY(0)}50%{transform:translateY(-20px)}100%{transform:translateY(0)}}
    @keyframes floatC{0%{transform:translateY(0)}50%{transform:translateY(-18px)}100%{transform:translateY(0)}}

    /* ---------- Wrapper & header ---------- */
    .wrap{max-width:var(--max-width);margin:26px auto;padding:0 20px;position:relative;z-index:10}
    header.site-header{
      display:flex;align-items:center;justify-content:space-between;
      background:linear-gradient(90deg, rgba(255,255,255,0.92), rgba(255,255,255,0.7));
      border-radius:var(--radius-lg);padding:14px 18px;box-shadow:var(--shadow-1);backdrop-filter:blur(6px);
      position:sticky;top:18px;z-index:40;
    }
    .brand{display:flex;gap:14px;align-items:center}
    .logo{
      width:68px;height:68px;border-radius:16px;background:linear-gradient(135deg,var(--primary),var(--violet));
      display:flex;align-items:center;justify-content:center;color:white;font-weight:800;font-family:"Baloo 2";font-size:20px;box-shadow:0 12px 40px rgba(17,55,120,0.14)
    }
    .brand h1{margin:0;font-size:20px;color:var(--dark)}
    .brand p{margin:0;color:var(--muted);font-size:13px}

    .header-actions{display:flex;align-items:center;gap:12px}
    .btn{
      border:0;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:700;display:inline-flex;gap:10px;align-items:center;
      box-shadow:0 6px 20px rgba(10,30,90,0.06);transition:transform .14s,box-shadow .14s,opacity .14s;
    }
    .btn.primary{background:linear-gradient(90deg,var(--primary),var(--violet));color:white}
    .btn.ghost{background:rgba(255,255,255,0.72);color:var(--dark);border:1px solid rgba(16,32,64,0.03)}

    .btn.primary:hover{transform:translateY(-3px)}
    .btn.ghost:hover{transform:translateY(-2px)}

    /* ---------- layout ---------- */
    .layout{display:grid;grid-template-columns:1fr 380px;gap:22px;margin-top:22px;align-items:start}
    @media(max-width:1100px){.layout{grid-template-columns:1fr}}
    .main-col{position:relative;z-index:10}

    /* ---------- card base ---------- */
    .card{
      background:var(--card);border-radius:var(--radius-md);padding:18px;box-shadow:var(--shadow-1);border:1px solid rgba(11,37,69,0.03);overflow:hidden;
    }
    .card h2{margin:0 0 8px 0;color:var(--primary);font-size:18px}
    .muted{color:var(--muted);font-size:13px}

    /* ---------- Welcome / CTA ---------- */
    .welcome{display:flex;gap:16px;align-items:center;flex-wrap:wrap}
    .cta{width:220px;padding:12px;border-radius:12px;background:linear-gradient(90deg,var(--accent),#e6f9ef)}

    /* ---------- Mood selector ---------- */
    .mood-grid{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
    .mood-tile{
      width:calc(20% - 10px);min-width:70px;aspect-ratio:1/1;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:22px;cursor:pointer;
      transition:transform .16s ease,box-shadow .18s;box-shadow:0 10px 26px rgba(17,55,120,0.06);border:1px solid rgba(11,37,69,0.03);
      background:linear-gradient(180deg,#fff,#f7fbff)
    }
    .mood-tile:hover{transform:translateY(-8px);box-shadow:0 20px 40px rgba(12,50,120,0.12)}
    .mood-tile[data-mood="happy"]{background:linear-gradient(90deg,#e6f9ff,#eaf8ff)}
    .mood-tile[data-mood="sad"]{background:linear-gradient(90deg,#f0fff6,#e9fdf2)}
    .mood-tile[data-mood="angry"]{background:linear-gradient(90deg,#fffaf0,#fff6e6)}
    .mood-tile[data-mood="tired"]{background:linear-gradient(90deg,#f3f6ff,#eef3ff)}
    .mood-tile[data-mood="calm"]{background:linear-gradient(90deg,#f0fff7,#e6fff0)}

    .suggestion{margin-top:12px;padding:12px;border-radius:10px;background:linear-gradient(90deg,#f7fbff,#ffffff);border-left:5px solid var(--primary)}

    /* ---------- Quote & tips carousel ---------- */
    .quote{font-size:18px;font-weight:700;margin:0;color:var(--dark)}
    .quote-sub{margin-top:6px;color:var(--muted);font-size:13px}
    .tips-carousel{display:flex;gap:8px;margin-top:10px;align-items:center}
    .tip{padding:10px 12px;background:linear-gradient(90deg,#fff,#f8fbff);border-radius:10px;border:1px solid rgba(11,37,69,0.03);min-width:220px}

    /* ---------- Journal ---------- */
    .journal-area textarea{width:100%;min-height:140px;padding:12px;border-radius:12px;border:1px solid rgba(11,37,69,0.06);font-size:15px;color:var(--dark);resize:vertical;background:linear-gradient(180deg,#fff,#fbfdff)}
    .journal-actions{display:flex;gap:10px;margin-top:10px;align-items:center}
    .small{font-size:13px}

    /* ---------- Breathing ---------- */
    .breath-wrap{text-align:center}
    .breath-circle{width:160px;height:160px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:8px auto;font-weight:700;color:#04315f;background:linear-gradient(180deg,#e8fff2,#dff6ff);box-shadow:0 16px 40px rgba(10,40,120,0.08)}
    .breath-circle.animate{animation:breathe2 8s infinite}
    @keyframes breathe2{0%{transform:scale(1)}25%{transform:scale(1.25)}50%{transform:scale(1)}75%{transform:scale(0.9)}100%{transform:scale(1)}}

    /* ---------- Games ---------- */
    .games{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
    .game-card{flex:1;min-width:220px;border-radius:12px;padding:12px;background:linear-gradient(180deg,#fff,#f7fbff);border:1px solid rgba(11,37,69,0.03);text-align:center;box-shadow:0 8px 24px rgba(12,40,120,0.06)}
    .big-button{padding:14px 18px;border-radius:12px;border:0;background:linear-gradient(90deg,var(--primary),var(--violet));color:white;font-size:16px;cursor:pointer;box-shadow:0 10px 30px rgba(17,55,120,0.12)}

    /* ---------- Resources ---------- */
    .resources-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;margin-top:12px}
    .resource{padding:14px;border-radius:12px;background:linear-gradient(180deg,#fff,#f9fffb);box-shadow:0 8px 28px rgba(8,32,72,0.06);cursor:pointer;border:1px solid rgba(11,37,69,0.03);transition:transform .18s}
    .resource:hover{transform:translateY(-6px) scale(1.02)}

    /* ---------- Sidebar ---------- */
    .sidebar{position:relative;top:0}
    .side-card{margin-bottom:12px}
    .emergency-btn{background:linear-gradient(90deg,var(--sun),#fff4c0);padding:12px;border-radius:12px;border:0;font-weight:700;color:#342b00;cursor:pointer;width:100%;display:flex;align-items:center;justify-content:space-between;box-shadow:0 8px 28px rgba(255,180,0,0.06)}
    .help-row{display:flex;gap:8px;align-items:center;margin-top:10px}

    /* ---------- Modal (Emergency) ---------- */
    .modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);width:420px;max-width:95%;z-index:200;background:var(--card);border-radius:12px;box-shadow:0 18px 60px rgba(12,40,90,0.18);padding:14px;display:none}
    .modal-row{display:flex;align-items:center;justify-content:space-between;padding:10px;border-radius:10px;background:linear-gradient(90deg,#fff,#f7fbff);margin-top:8px}
    .copy-btn{background:linear-gradient(90deg,var(--primary),var(--violet));color:white;border:0;padding:8px 10px;border-radius:8px;cursor:pointer}
    .close-x{position:absolute;right:10px;top:10px;background:transparent;border:0;font-size:18px;cursor:pointer;color:var(--muted)}

    /* ---------- Chatbot popup (with close/cut button) ---------- */
    .chatbot-popup{
      position:fixed;right:22px;bottom:20px;width:420px;height:540px;border-radius:14px;overflow:hidden;box-shadow:var(--shadow-2);background:var(--card);display:none;z-index:250;border:1px solid rgba(11,37,69,0.04)
    }
    .chatbot-popup iframe{width:100%;height:100%;border:0;display:block}
    /* Cut/close button â€” requested */
    #close-chatbot {
      position:absolute; top:10px; right:12px; z-index:260; background:#ff4d6d; border:none; color:white; font-size:18px;
      width:34px; height:34px; border-radius:50%; cursor:pointer; box-shadow:0 6px 18px rgba(0,0,0,0.18);
      display:flex; align-items:center; justify-content:center; font-weight:700;
    }
    #close-chatbot:hover{background:#ff1a45}

    /* ---------- Footer ---------- */
    footer.site-footer{margin-top:24px;padding:18px;text-align:center;background:linear-gradient(90deg,#f4fff9,#f1f6ff);border-radius:12px;color:var(--muted);box-shadow:var(--shadow-1);position:relative;z-index:20}
    .footer-controls{display:flex;gap:12px;justify-content:center;margin-top:12px;flex-wrap:wrap}

    /* ---------- Analytics panel (hidden by default) ---------- */
    .analytics-panel{position:fixed;left:18px;top:90px;width:520px;max-height:72vh;overflow:auto;z-index:300;background:rgba(255,255,255,0.98);border-radius:12px;padding:12px;box-shadow:0 18px 60px rgba(10,30,80,0.18);display:none}
    .analytics-panel pre{white-space:pre-wrap;word-wrap:break-word;font-size:13px;color:var(--muted);font-family:var(--mono);}

    /* ---------- Accessibility focus styles ---------- */
    :focus{outline:3px solid rgba(43,124,255,0.12);outline-offset:2px}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

    /* ---------- Responsive tweaks ---------- */
    @media(max-width:700px){
      .mood-tile{width:48%}
      .brand h1{font-size:18px}
      .brand p{display:none}
      .chatbot-popup{right:12px;left:12px;width:calc(100% - 24px);height:60vh}
    }

    /* ---------- extra small animations to enrich UI ---------- */
    .pulse{animation:pulse 2.6s infinite}
    @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.03)}100%{transform:scale(1)}}
  </style>
</head>
<body><!-- LOGIN OVERLAY (B2 Style) -->
<div id="loginOverlay" style="position:fixed;top:0; left:0;width:100%; height:100%;background:rgba(255,255,255,0.90);backdrop-filter:blur(6px);display:flex;justify-content:center;align-items:center;z-index:999999;">
<div style="width:350px;padding:25px;background:white;border-radius:15px;box-shadow:0 10px 40px rgba(0,0,0,0.15);text-align:center;">
<h2 style="color:#2b7cff; margin-bottom:20px;">CampusCare Login</h2>
<input id="user" placeholder="Enter Username" style="width:100%; padding:12px; margin:10px 0; border-radius:10px; border:1px solid #ccc; font-size:16px;" type="text"/>
<input id="pass" placeholder="Enter Password" style="width:100%; padding:12px; margin:10px 0; border-radius:10px; border:1px solid #ccc; font-size:16px;" type="password"/>
<button onclick="loginUser()" style="width:100%; padding:12px; border:none; border-radius:10px; background:#2b7cff; color:white; font-size:17px; cursor:pointer; font-weight:bold;">Login</button>
<div id="err" style="color:red; font-size:14px; display:none; margin-top:10px;">Invalid username or password!</div>
<div style="margin:15px 0; font-weight:bold; color:#666;">OR</div>
<div data-callback="handleGoogleLogin" data-client_id="PASTE-YOUR-CLIENT-ID-HERE" data-context="signin" data-ux_mode="popup" id="g_id_onload"></div>
<div class="g_id_signin" data-size="large" data-theme="outline" data-type="standard"></div>
</div>
</div>

<!-- Decorative bg shapes -->
<div class="bg-shape one"></div>
<div class="bg-shape two"></div>
<div class="bg-shape three"></div>
<div class="wrap">
<!-- Header -->
<header aria-label="CampusCare header" class="site-header" role="banner">
<div class="brand">
<div class="logo">CC</div>
<div>
<h1>CampusCare</h1>
<p>Friendly digital companion for student well-being</p>
</div>
</div>
<div aria-label="Header actions" class="header-actions" role="navigation">
<!-- Only chatbot and quick help per your request -->
<button class="btn primary" id="openChatBtn" title="Open Chatbot"><i class="fa-solid fa-robot"></i> Chat with CampusCare</button>
<button class="btn ghost" id="helpQuickBtn" title="Emergency Quick Help"><i class="fa-solid fa-phone"></i> Quick Help</button>
</div>
</header>
<!-- Main layout -->
<main class="layout" role="main">
<!-- LEFT column -->
<section aria-labelledby="mainTitle" class="card main-col">
<h2 id="mainTitle">Welcome â€” You matter</h2>
<div class="welcome" style="margin-top:8px">
<div class="left" style="flex:1">
<p class="muted">Use quick tools below â€” mood selector, breathing, games, and private journaling. Everything can be exported locally if you want to keep a copy.</p>
<div style="display:flex;gap:10px;margin-top:12px;flex-wrap:wrap;align-items:center">
<div class="cta">
<div style="font-weight:700;color:var(--primary)">Today's micro-tip</div>
<div class="muted" style="margin-top:6px;font-size:13px">After studying for 25 minutes, take a 5-minute break to move and breathe.</div>
</div>
<div style="flex:1"></div>
</div>
</div>
</div>
<!-- Mood -->
<div style="margin-top:18px">
<h2 style="font-size:16px">How are you feeling right now?</h2>
<div aria-label="Mood choices" class="mood-grid" id="moodGrid" role="group">
<div class="mood-tile" data-mood="happy" tabindex="0" title="Happy">ðŸ˜Š</div>
<div class="mood-tile" data-mood="sad" tabindex="0" title="Sad">ðŸ˜”</div>
<div class="mood-tile" data-mood="angry" tabindex="0" title="Angry">ðŸ˜ </div>
<div class="mood-tile" data-mood="tired" tabindex="0" title="Tired">ðŸ˜´</div>
<div class="mood-tile" data-mood="calm" tabindex="0" title="Calm">ðŸ˜Œ</div>
</div>
<div class="suggestion" id="moodSuggestion" style="display:none"></div>
</div>
<!-- Quote & tips -->
<div style="margin-top:18px">
<h2 style="font-size:16px">Daily Motivation</h2>
<div style="display:flex;gap:12px;align-items:center">
<div style="flex:1">
<p class="quote" id="dailyQuote">Loading inspirational message...</p>
<p class="quote-sub" id="quoteAuthor">â€”</p>
</div>
<div style="display:flex;flex-direction:column;gap:8px">
<button class="btn primary" id="newQuoteBtn"><i class="fa-solid fa-sync"></i> New</button>
<button class="btn ghost" id="saveQuoteBtn"><i class="fa-solid fa-star"></i> Save</button>
</div>
</div>
<div aria-live="polite" class="tips-carousel" id="tipsCarousel" style="margin-top:12px"></div>
</div>
<!-- Journal -->
<div style="margin-top:18px">
<h2 style="font-size:16px">Private Journal</h2>
<p class="muted">Stored locally on your device. Export any time.</p>
<div class="journal-area" style="margin-top:8px">
<textarea id="journalInput" placeholder="Write anything you want..."></textarea>
<div class="journal-actions">
<button class="btn primary" id="saveJournal"><i class="fa-solid fa-save"></i> Save</button>
<button class="btn ghost" id="clearJournal"><i class="fa-solid fa-trash"></i> Clear</button>
<button class="btn" id="exportJournal" style="background:linear-gradient(90deg,var(--violet),var(--primary));color:white"><i class="fa-solid fa-file-export"></i> Export</button>
<div style="flex:1"></div>
<div class="small muted" id="journalMeta">Last saved: never</div>
</div>
</div>
</div>
<!-- Breathing -->
<div style="margin-top:18px">
<h2 style="font-size:16px">Guided Breathing</h2>
<p class="muted">Follow the circle: inhale as it expands, exhale as it shrinks.</p>
<div style="text-align:center;margin-top:10px">
<div class="breath-circle" id="breathCircle">Breathe</div>
<div style="margin-top:10px;display:flex;gap:10px;justify-content:center">
<button class="btn primary" id="startBreathBtn"><i class="fa-solid fa-play"></i> Start</button>
<button class="btn ghost" id="stopBreathBtn"><i class="fa-solid fa-stop"></i> Stop</button>
<button class="btn" id="breathGuideBtn" style="background:linear-gradient(90deg,var(--accent),#bff1e0)"><i class="fa-solid fa-circle-info"></i> How</button>
</div>
</div>
</div>
<!-- Games -->
<div style="margin-top:18px">
<h2 style="font-size:16px">Quick Games</h2>
<div class="games">
<div class="game-card">
<h3 style="margin:6px 0 8px 0">Click Stress-Buster</h3>
<p class="muted">Click the button as many times as possible in 10 seconds.</p>
<div style="margin:10px 0">
<button class="big-button" id="tapButton">Tap me</button>
</div>
<div class="muted">Score: <strong id="tapScore">0</strong></div>
<div style="margin-top:10px">
<button class="btn ghost" id="startTapGame"><i class="fa-solid fa-hourglass-start"></i> Start 10s</button>
</div>
</div>
<div class="game-card">
<h3 style="margin:6px 0 8px 0">Mini Memory</h3>
<p class="muted">Remember the number shown for 2 seconds.</p>
<div style="font-size:22px;margin:10px 0"><strong id="memoryDisplay">---</strong></div>
<div style="display:flex;gap:8px;justify-content:center">
<button class="btn primary" id="playMemoryBtn"><i class="fa-solid fa-dice"></i> Play</button>
<button class="btn ghost" id="guessMemoryBtn"><i class="fa-solid fa-clipboard"></i> Guess</button>
</div>
<div class="muted" id="memoryResult" style="margin-top:8px"></div>
</div>
</div>
</div>
<!-- Resources -->
<div style="margin-top:18px">
<h2 style="font-size:16px">Explore Resources</h2>
<div class="resources-grid" id="resourcesGrid">
<div class="resource" data-link="https://www.youtube.com/watch?v=zPyg4N7bcHM&amp;list=RDzPyg4N7bcHM&amp;start_radio=1&amp;pp=ygUQc2hvcnQgY2FsbSB2aWRlb6AHAQ%3D%3D" role="link" tabindex="0">
<i class="fa-solid fa-video" style="font-size:22px;color:var(--primary)"></i>
<h3 style="margin:8px 0 6px 0">Short Calm Videos</h3>
<p class="muted">Watch calming videos to relax your mind.</p>
</div>
<div class="resource" data-link="https://www.mayoclinic.org/healthy-lifestyle/consumer-health/in-depth/mindfulness-exercises/art-20046356" role="link" tabindex="0">
<i class="fa-solid fa-leaf" style="font-size:22px;color:var(--accent)"></i>
<h3 style="margin:8px 0 6px 0">Mindfulness Tips</h3>
<p class="muted">Read easy mindfulness exercises for focus.</p>
</div>
<div class="resource" data-link="https://www.verywellfit.com/essential-yoga-poses-for-beginners-3566747" role="link" tabindex="0">
<i class="fa-solid fa-spa" style="font-size:22px;color:var(--violet)"></i>
<h3 style="margin:8px 0 6px 0">Simple Yoga</h3>
<p class="muted">Practice beginner-friendly yoga poses daily.</p>
</div>
<div class="resource" data-link="https://www.youtube.com/watch?v=2OEL4P1Rz04" role="link" tabindex="0">
<i class="fa-solid fa-music" style="font-size:22px;color:#2b7cff"></i>
<h3 style="margin:8px 0 6px 0">Relaxing Music</h3>
<p class="muted">Play calm background music to study or relax.</p>
</div>
</div>
</div>
<!-- Relaxation player embed -->
<div style="margin-top:18px">
<h2 style="font-size:16px">Relaxation Player</h2>
<div style="border-radius:12px;overflow:hidden;box-shadow:0 12px 34px rgba(10,30,80,0.06)">
<iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" frameborder="0" height="220" id="relaxPlayer" src="https://www.youtube.com/embed/zPyg4N7bcHM?rel=0&amp;controls=1&amp;modestbranding=1" title="Relaxing Video" width="100%"></iframe>
</div>
</div>
</section>
<!-- RIGHT Sidebar -->
<aside aria-label="Sidebar" class="sidebar">
<div class="card side-card">
<h2 style="font-size:16px">Quick Emergency</h2>
<p class="muted">Tap the button to open important helplines. Call on mobile or copy the number.</p>
<button class="emergency-btn" id="openEmergencyBtn"><span><i class="fa-solid fa-phone-alt"></i> Emergency Numbers</span><span class="muted small">Tap</span></button>
<div class="muted" style="margin-top:10px">
<div class="help-row"><i class="fa-solid fa-user"></i>
<div><div style="font-weight:700">College Counsellor</div><div class="small muted">+91 7860763040</div></div>
</div>
<div class="help-row"><i class="fa-solid fa-user-tie"></i>
<div><div style="font-weight:700">Student Counsellor</div><div class="small muted">+91 7524860101</div></div>
</div>
<div class="help-row"><i class="fa-solid fa-hands-helping"></i>
<div><div style="font-weight:700">Friend Support</div><div class="small muted">+91 9871677506</div></div>
</div>
</div>
</div>
<div class="card side-card">
<h2 style="font-size:16px">Mini Tools</h2>
<p class="muted">Quick access to features.</p>
<div style="display:flex;flex-direction:column;gap:8px;margin-top:10px">
<button class="btn ghost" id="openChatbotSidebar"><i class="fa-solid fa-robot"></i> Open Chatbot</button>
<button class="btn ghost" id="openRelaxPlayer"><i class="fa-solid fa-music"></i> Open Relax Player</button>
<button class="btn ghost" id="exportLocalDataBtn"><i class="fa-solid fa-download"></i> Export Local Data</button>
</div>
</div>
<div class="card side-card">
<h2 style="font-size:16px">Resources</h2>
<div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
<a class="muted" href="https://student-mind-mentor.lovable.app/" style="text-decoration:none" target="_blank"><i class="fa-solid fa-globe"></i> External demo site</a>
<a class="muted" href="#" id="openMindTips" style="text-decoration:none"><i class="fa-solid fa-book"></i> Mindfulness (Mayo Clinic)</a>
<a class="muted" href="#" id="openYogaLink" style="text-decoration:none"><i class="fa-solid fa-spa"></i> Simple Yoga</a>
</div>
</div>
</aside>
</main>
<!-- Footer -->
<footer class="site-footer" role="contentinfo">
<div style="font-weight:700">CampusCare</div>
<div class="muted" style="margin-top:6px">Built to support student well-being â€¢ Local-only storage by default</div>
<div class="footer-controls" style="margin-top:12px">
<button class="btn primary" id="openChatBtnFooter"><i class="fa-solid fa-robot"></i> Chat with CampusCare</button>
<button class="btn ghost" id="openEmergencyFooter"><i class="fa-solid fa-phone"></i> Emergency</button>
</div>
<div class="muted" style="margin-top:12px">Â© 2025 CampusCare â€” Made with care</div>
</footer>
</div> <!-- end wrap -->
<!-- Emergency modal -->
<div aria-label="Emergency numbers" aria-modal="true" class="modal" id="emergencyModal" role="dialog">
<button class="close-x" id="closeEmergencyModal" title="Close">Ã—</button>
<h3 style="margin:0 0 6px 0">Important Helplines</h3>
<p class="muted" style="margin-top:0">Tap Call to call (mobile) or Copy to copy the number.</p>
<div style="margin-top:12px">
<div class="modal-row">
<div><div style="font-weight:700">National Helpline</div><div class="muted small">+91 11234 56789</div></div>
<div style="display:flex;flex-direction:column;gap:6px">
<a class="btn ghost" href="tel:+911123456789" style="padding:6px 10px">Call</a>
<button class="copy-btn" data-num="+911123456789">Copy</button>
</div>
</div>
<div class="modal-row">
<div><div style="font-weight:700">College Counsellor</div><div class="muted small">+91 7860763040</div></div>
<div style="display:flex;flex-direction:column;gap:6px">
<a class="btn ghost" href="tel:+917860763040" style="padding:6px 10px">Call</a>
<button class="copy-btn" data-num="+917860763040">Copy</button>
</div>
</div>
<div class="modal-row">
<div><div style="font-weight:700">Student Counsellor</div><div class="muted small">+91 7524860101</div></div>
<div style="display:flex;flex-direction:column;gap:6px">
<a class="btn ghost" href="tel:+917524860101" style="padding:6px 10px">Call</a>
<button class="copy-btn" data-num="+917524860101">Copy</button>
</div>
</div>
<div class="modal-row">
<div><div style="font-weight:700">Friend Support</div><div class="muted small">+91 9871677506</div></div>
<div style="display:flex;flex-direction:column;gap:6px">
<a class="btn ghost" href="tel:+919871677506" style="padding:6px 10px">Call</a>
<button class="copy-btn" data-num="+919871677506">Copy</button>
</div>
</div>
<div class="modal-row">
<div><div style="font-weight:700">Emergency Ambulance</div><div class="muted small">+91 102</div></div>
<div style="display:flex;flex-direction:column;gap:6px">
<a class="btn ghost" href="tel:+91102" style="padding:6px 10px">Call</a>
<button class="copy-btn" data-num="+91102">Copy</button>
</div>
</div>
</div>
</div>
<!-- Chatbot popup with CUT/CLOSE button included -->
<div aria-hidden="true" aria-label="Chatbot popup" class="chatbot-popup" id="chatbotPopup">
<!-- CUT / CLOSE button requested -->
<button id="close-chatbot" title="Close chatbot">âœ•</button>
<iframe id="chatbotIframe" src="" title="CampusCare Chatbot"></iframe>
</div>
<!-- Analytics panel (toggle via Ctrl+Shift+A) -->
<div aria-hidden="true" class="analytics-panel" id="analyticsPanel">
<h3 style="margin:0 0 8px 0">Local Analytics (dev)</h3>
<div class="muted small" style="margin-bottom:8px">Stored only in your browser (localStorage). Toggle with Ctrl+Shift+A</div>
<pre id="analyticsContent">Loading analytics...</pre>
<div style="display:flex;justify-content:space-between;margin-top:8px">
<button class="btn ghost" id="analyticsClose">Close</button>
<button class="btn primary" id="analyticsExport">Download JSON</button>
</div>
</div>
<!-- ======================
       JavaScript (expanded)
       ====================== -->
<script>
  /*
    CampusCare â€” expanded JS
    - Chatbot popup with close (cut) button
    - Emergency modal (call & copy)
    - Local analytics (privacy-first)
    - Mood handling, tips carousel, quotes
    - Journal save/export
    - Breathing & games
    - Resource links open externally
    - Analytics panel toggle (Ctrl+Shift+A)
  */

  (function(){
    'use strict';

    /*** Utility helpers ***/
    function q(sel, p=document){ return p.querySelector(sel); }
    function qa(sel, p=document){ return Array.from((p||document).querySelectorAll(sel)); }
    function el(tag, props){ const e = document.createElement(tag); if(props) Object.assign(e,props); return e; }
    function nowISO(){ return new Date().toISOString(); }

    /*** Analytics (local) ***/
    const ANALYTICS_KEY = '__campuscare_local_analytics_v3';
    const analyticsDefaults = {
      visits:0,
      moodClicks:{},
      games:{tapPlays:0,tapScores:[],memoryPlays:0,memoryResults:[]},
      journalSaves:0,
      chatbotOpens:0,
      emergencyOpens:0,
      events:[]
    };

    function loadAnalytics(){
      try{
        const raw = localStorage.getItem(ANALYTICS_KEY);
        return raw ? JSON.parse(raw) : JSON.parse(JSON.stringify(analyticsDefaults));
      }catch(e){ return JSON.parse(JSON.stringify(analyticsDefaults)); }
    }
    function saveAnalytics(data){
      try{ localStorage.setItem(ANALYTICS_KEY, JSON.stringify(data)); }catch(e){}
    }
    function recordEvent(type, payload){
      const data = loadAnalytics();
      data.lastUpdate = nowISO();
      data.events = data.events || [];
      data.events.push({ t: nowISO(), type, payload: payload || null });
      if(type === 'visit') data.visits = (data.visits||0)+1;
      if(type === 'mood') data.moodClicks[payload] = (data.moodClicks[payload]||0)+1;
      if(type === 'journal_save') data.journalSaves = (data.journalSaves||0)+1;
      if(type === 'chatbot_open') data.chatbotOpens = (data.chatbotOpens||0)+1;
      if(type === 'emergency_open') data.emergencyOpens = (data.emergencyOpens||0)+1;
      if(type === 'tap_end'){ data.games.tapPlays = (data.games.tapPlays||0)+1; data.games.tapScores.push(payload||0); }
      if(type === 'memory_play') data.games.memoryPlays = (data.games.memoryPlays||0)+1;
      if(type === 'memory_result') data.games.memoryResults.push(payload||null);
      saveAnalytics(data);
      updateAnalyticsPanel();
    }

    // mark initial visit
    recordEvent('visit');

    /*** DOM refs ***/
    const moodGrid = q('#moodGrid');
    const moodTiles = qa('.mood-tile', moodGrid);
    const moodSuggestion = q('#moodSuggestion');
    const dailyQuote = q('#dailyQuote');
    const quoteAuthor = q('#quoteAuthor');
    const newQuoteBtn = q('#newQuoteBtn');
    const saveQuoteBtn = q('#saveQuoteBtn');
    const tipsCarousel = q('#tipsCarousel');

    const journalInput = q('#journalInput');
    const saveJournalBtn = q('#saveJournal');
    const clearJournalBtn = q('#clearJournal');
    const exportJournalBtn = q('#exportJournal');
    const journalMeta = q('#journalMeta');

    const breathCircle = q('#breathCircle');
    const startBreathBtn = q('#startBreathBtn');
    const stopBreathBtn = q('#stopBreathBtn');
    const breathGuideBtn = q('#breathGuideBtn');

    const tapButton = q('#tapButton');
    const tapScore = q('#tapScore');
    const startTapGameBtn = q('#startTapGame');

    const memoryDisplay = q('#memoryDisplay');
    const playMemoryBtn = q('#playMemoryBtn');
    const guessMemoryBtn = q('#guessMemoryBtn');
    const memoryResult = q('#memoryResult');

    const resourcesGrid = q('#resourcesGrid');

    const openEmergencyBtn = q('#openEmergencyBtn');
    const emergencyModal = q('#emergencyModal');
    const closeEmergencyModal = q('#closeEmergencyModal');
    const copyButtons = qa('.copy-btn', emergencyModal);

    const openChatBtn = q('#openChatBtn');
    const openChatBtnFooter = q('#openChatBtnFooter');
    const openChatbotSidebar = q('#openChatbotSidebar') || null;
    const chatbotPopup = q('#chatbotPopup');
    const chatbotIframe = q('#chatbotIframe');
    const closeChatbotBtn = q('#close-chatbot');

    const helpQuickBtn = q('#helpQuickBtn');
    const openEmergencyFooter = q('#openEmergencyFooter');
    const openRelaxPlayerBtn = q('#openRelaxPlayer');
    const openMindTips = q('#openMindTips');
    const openYogaLink = q('#openYogaLink');
    const exportLocalDataBtn = q('#exportLocalDataBtn');

    // analytics UI
    const analyticsPanel = q('#analyticsPanel');
    const analyticsContent = q('#analyticsContent');
    const analyticsClose = q('#analyticsClose');
    const analyticsExport = q('#analyticsExport');

    /*** Quotes & Tips data ***/
    const QUOTES = [
      { text:"Small steps are still progress â€” keep going.", author:"CampusCare" },
      { text:"Breathe. One moment at a time.", author:"CampusCare" },
      { text:"Rest is part of work; your mind needs care.", author:"Self-Care" },
      { text:"Ask for help when you need it â€” it's a strength.", author:"Community Wisdom" },
      { text:"Kindness to yourself is a practice, not a luxury.", author:"Gentle Reminder" },
      { text:"You are learning â€” mistakes are part of growth.", author:"Learning" },
      { text:"Compare less, create more.", author:"Creator Mindset" }
    ];

    const TIPS = [
      { text:"Set a small goal for the next 30 minutes â€” focus on one task." },
      { text:"Take a 5-minute walk and notice three things you see." },
      { text:"Use the breathing exercise for 2 cycles when anxious." },
      { text:"Write down one thing you did well today." },
      { text:"Limit social scrolling before bedtime for better sleep." },
      { text:"Talk to a friend for 10 minutes â€” connection helps." },
      { text:"Try grounding: name 5 things you can see right now." },
      { text:"Stand up and stretch every hour to refresh your mind." },
      { text:"Keep a water bottle nearby â€” dehydration affects mood." },
      { text:"If overwhelmed, list 3 next small actions and do one." }
    ];

    function randomOf(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    /*** Initialization ***/
    function init(){
      // set quote (stored or random)
      const storedQuote = localStorage.getItem('campus_quote_v2');
      if(storedQuote){
        try{
          const q = JSON.parse(storedQuote);
          dailyQuote.textContent = q.text || randomOf(QUOTES).text;
          quoteAuthor.textContent = q.author ? 'â€” ' + q.author : '';
        }catch(e){
          setNewQuote();
        }
      }else setNewQuote();

      renderTips();
      loadJournal();

      // resource cards: open link on click
      qa('.resource', resourcesGrid).forEach(card=>{
        card.addEventListener('click', ()=>{ const link = card.dataset.link; if(link) window.open(link, '_blank'); });
        card.addEventListener('keydown', (e)=>{ if(e.key === 'Enter'){ const link = card.dataset.link; if(link) window.open(link, '_blank'); } });
      });

      // sidebar quick links
      if(openMindTips) openMindTips.addEventListener('click', (e)=>{ e.preventDefault(); window.open('https://www.mayoclinic.org/healthy-lifestyle/consumer-health/in-depth/mindfulness-exercises/art-20046356', '_blank'); });
      if(openYogaLink) openYogaLink.addEventListener('click', (e)=>{ e.preventDefault(); window.open('https://www.verywellfit.com/essential-yoga-poses-for-beginners-3566747','_blank'); });

      // chat triggers
      openChatBtn.addEventListener('click', ()=>{ openChatbot(); recordEvent('chatbot_trigger','header'); });
      if(openChatBtnFooter) openChatBtnFooter.addEventListener('click', ()=>{ openChatbot(); recordEvent('chatbot_trigger','footer'); });
      if(openChatbotSidebar) openChatbotSidebar.addEventListener('click', ()=>{ openChatbot(); recordEvent('chatbot_trigger','sidebar'); });

      // emergency triggers
      openEmergencyBtn.addEventListener('click', ()=>{ openEmergency(); });
      if(openEmergencyFooter) openEmergencyFooter.addEventListener('click', ()=>{ openEmergency(); });
      if(helpQuickBtn) helpQuickBtn.addEventListener('click', ()=>{ openEmergency(); });

      // close emergency
      closeEmergencyModal.addEventListener('click', ()=>{ emergencyModal.style.display = 'none'; });

      // copy buttons inside modal
      copyButtons.forEach(btn=>{
        btn.addEventListener('click', ()=>{ navigator.clipboard.writeText(btn.dataset.num).then(()=>{ alert('Copied '+btn.dataset.num); recordEvent('copy_number',{num:btn.dataset.num}); }); });
      });

      // relax-player
      if(openRelaxPlayerBtn) openRelaxPlayerBtn.addEventListener('click', ()=>{ document.getElementById('relaxPlayer').scrollIntoView({behavior:'smooth'}); });

      // breathing
      startBreathBtn.addEventListener('click', startBreathing);
      stopBreathBtn.addEventListener('click', stopBreathing);
      breathGuideBtn.addEventListener('click', ()=> alert('Practice: Breathe in 4s â†’ hold 4s â†’ breathe out 4s â†’ relax 4s. Repeat 3â€“5 times.'));

      // games
      startTapGameBtn.addEventListener('click', startTapGame);
      tapButton.addEventListener('click', ()=>{ tapCount++; tapScore.textContent = tapCount; });
      playMemoryBtn.addEventListener('click', playMemoryNumber);
      guessMemoryBtn.addEventListener('click', guessMemory);

      // journal
      saveJournalBtn.addEventListener('click', saveJournal);
      clearJournalBtn.addEventListener('click', clearJournal);
      exportJournalBtn.addEventListener('click', exportJournal);

      // mood tiles
      moodTiles.forEach(tile=>{ tile.addEventListener('click', ()=>{ handleMoodClick(tile.dataset.mood); }); tile.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') handleMoodClick(tile.dataset.mood); }); });

      // quote controls
      newQuoteBtn.addEventListener('click', setNewQuote);
      saveQuoteBtn.addEventListener('click', saveQuote);

      // chatbot close (cut) button
      closeChatbotBtn.addEventListener('click', ()=>{ closeChatbot(); });

      // close chatbot on ESC key
      document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape'){ if(chatbotPopup.style.display === 'block') closeChatbot(); } });

      // analytics toggle: Ctrl+Shift+A
      document.addEventListener('keydown', (e)=>{ if(e.ctrlKey && e.shiftKey && e.code === 'KeyA'){ toggleAnalyticsPanel(); } });

      analyticsClose.addEventListener('click', ()=>{ analyticsPanel.style.display = 'none'; });
      analyticsExport.addEventListener('click', downloadAnalyticsJson);

      // export local data button
      if(exportLocalDataBtn) exportLocalDataBtn.addEventListener('click', ()=>{ downloadAnalyticsJson(); alert('Local analytics exported.'); });

      // initial update analytics panel
      updateAnalyticsPanel();
    } // end init

    /*** Mood handlers ***/
    function handleMoodClick(mood){
      const map = {
        happy:{text:"Nice â€” celebrate small wins! Try sharing a smile or a short walk.", color:'#e6f9ff'},
        sad:{text:"It's okay to feel low. Try 5 deep breaths or write freely for 5 minutes.", color:'#eefdf6'},
        angry:{text:"Use quick physical release (walk/stretch) then breathe.", color:'#fffaf0'},
        tired:{text:"Consider a 20-minute power nap or a short walk. Hydrate too.", color:'#f3f7ff'},
        calm:{text:"Stay steady â€” practice 2 minutes of mindful breathing.", color:'#f0fff7'}
      };
      const info = map[mood] || {text:"Take a moment. You're doing your best.", color:'#fff'};
      moodSuggestion.style.display = 'block';
      moodSuggestion.innerHTML = '<div style="font-weight:700;text-transform:capitalize">'+mood+'</div><div style="margin-top:6px" class="muted">'+info.text+'</div>';
      recordEvent('mood', mood);
    }

    /*** Tips carousel ***/
    function renderTips(){
      tipsCarousel.innerHTML = '';
      const copy = [...TIPS].sort(()=>0.5 - Math.random()).slice(0,4);
      copy.forEach(t=>{
        const tipEl = el('div',{className:'tip'});
        tipEl.innerHTML = `<div style="font-weight:700;margin-bottom:6px">Tip</div><div class="small">${t.text}</div>`;
        tipsCarousel.appendChild(tipEl);
      });
    }

    /*** Quotes ***/
    function setNewQuote(){
      const q = randomOf(QUOTES);
      dailyQuote.textContent = q.text;
      quoteAuthor.textContent = q.author ? 'â€” ' + q.author : '';
      try{ localStorage.setItem('campus_quote_v2', JSON.stringify(q)); }catch(e){}
      recordEvent('quote_new', q);
    }
    function saveQuote(){
      const q = { text: dailyQuote.textContent, author: quoteAuthor.textContent.replace(/^â€”\s*/,'') || '', savedAt: nowISO() };
      try{
        let arr = JSON.parse(localStorage.getItem('campus_saved_quotes_v2') || '[]');
        arr.unshift(q);
        localStorage.setItem('campus_saved_quotes_v2', JSON.stringify(arr.slice(0,50)));
        alert('Quote saved locally.');
        recordEvent('quote_save', q);
      }catch(e){ console.warn('quote save failed', e); }
    }

    /*** Journal ***/
    function loadJournal(){
      try{
        const t = localStorage.getItem('campus_journal_text_v2') || '';
        journalInput.value = t;
        const ts = localStorage.getItem('campus_journal_last_saved_v2');
        journalMeta.textContent = ts ? 'Last saved: ' + new Date(ts).toLocaleString() : 'Last saved: never';
      }catch(e){}
    }
    function saveJournal(){
      try{
        const t = journalInput.value || '';
        localStorage.setItem('campus_journal_text_v2', t);
        localStorage.setItem('campus_journal_last_saved_v2', nowISO());
        journalMeta.textContent = 'Last saved: ' + new Date().toLocaleString();
        alert('Journal saved locally on this device.');
        recordEvent('journal_save', {length: (t||'').length});
      }catch(e){ alert('Failed to save journal locally.'); }
    }
    function clearJournal(){
      if(!confirm('Clear your local journal? This will remove saved text from this device.')) return;
      journalInput.value = '';
      localStorage.removeItem('campus_journal_text_v2');
      localStorage.removeItem('campus_journal_last_saved_v2');
      journalMeta.textContent = 'Last saved: never';
      recordEvent('journal_clear');
    }
    function exportJournal(){
      try{
        const t = journalInput.value || '';
        const blob = new Blob([t], {type:'text/plain;charset=utf-8'});
        const url = URL.createObjectURL(blob);
        const a = el('a',{href:url});
        a.download = 'campuscare_journal.txt';
        document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
        recordEvent('journal_export');
      }catch(e){ alert('Export failed.'); }
    }

    /*** Breathing ***/
    let breathInterval = null;
    const breathPhases = ['Breathe In', 'Hold', 'Breathe Out', 'Relax'];
    function startBreathing(){
      if(breathInterval) return;
      let idx = 0;
      breathCircle.classList.add('animate');
      breathCircle.textContent = breathPhases[idx];
      breathInterval = setInterval(()=>{ idx = (idx+1)%breathPhases.length; breathCircle.textContent = breathPhases[idx]; }, 4000);
      recordEvent('breathing_start');
    }
    function stopBreathing(){
      if(!breathInterval) return;
      clearInterval(breathInterval);
      breathInterval = null;
      breathCircle.classList.remove('animate');
      breathCircle.textContent = 'Breathe';
      recordEvent('breathing_stop');
    }

    /*** Tap (click) game ***/
    let tapTimer = null, tapCount = 0;
    function startTapGame(){
      if(tapTimer){ clearTimeout(tapTimer); tapTimer = null; }
      tapCount = 0; tapScore.textContent = '0';
      tapButton.disabled = false; tapButton.style.opacity = 1;
      tapTimer = setTimeout(()=>{
        tapButton.disabled = true;
        alert('Time up! Score: ' + tapCount);
        recordEvent('tap_end', tapCount);
        tapTimer = null;
      },10000);
    }

    /*** Memory game ***/
    let memoryNumber = null;
    function playMemoryNumber(){
      memoryNumber = Math.floor(Math.random()*900 + 100);
      memoryDisplay.textContent = memoryNumber;
      recordEvent('memory_play');
      setTimeout(()=>{ memoryDisplay.textContent = '???'; }, 2000);
    }
    function guessMemory(){
      if(!memoryNumber){ memoryResult.textContent = 'Play first to see a number.'; return; }
      const guess = prompt('Enter the number you remember:');
      if(guess === null) return;
      if(String(guess).trim() === String(memoryNumber)){
        memoryResult.textContent = 'ðŸŽ‰ Correct!';
        recordEvent('memory_result',{ok:true,value:memoryNumber});
      } else {
        memoryResult.textContent = 'âŒ Oops â€” it was ' + memoryNumber;
        recordEvent('memory_result',{ok:false,guess:String(guess),value:memoryNumber});
      }
      memoryNumber = null; memoryDisplay.textContent = '---';
    }

    /*** Emergency modal ***/
    function openEmergency(){
      emergencyModal.style.display = 'block';
      recordEvent('emergency_open');
    }

    /*** Chatbot popup (open, close) with CUT button ***/
    const BOT_URL = "https://cdn.botpress.cloud/webchat/v3.2/shareable.html?configUrl=https://files.bpcontent.cloud/2025/09/14/06/20250914063136-IUN9PGZ1.json";
    function openChatbot(){
      chatbotPopup.style.display = 'block';
      chatbotIframe.src = BOT_URL;
      recordEvent('chatbot_open');
    }
    function closeChatbot(){
      chatbotPopup.style.display = 'none';
      chatbotIframe.src = '';
    }

    // Close chatbot if user clicks outside (optional)
    document.addEventListener('click', (e)=>{
      if(chatbotPopup.style.display === 'block'){
        const target = e.target;
        if(!chatbotPopup.contains(target) && !q('#openChatBtn').contains(target) && !q('#openChatBtnFooter')?.contains(target)){
          // do not auto-close to avoid annoyance; commented out intentionally
          // closeChatbot();
        }
      }
    });

    /*** Analytics panel ***/
    function toggleAnalyticsPanel(){
      if(analyticsPanel.style.display === 'block'){ analyticsPanel.style.display = 'none'; }
      else { analyticsPanel.style.display = 'block'; updateAnalyticsPanel(); }
    }
    function updateAnalyticsPanel(){
      try{
        const d = loadAnalytics();
        analyticsContent.textContent = JSON.stringify(d, null, 2);
      }catch(e){}
    }
    function downloadAnalyticsJson(){
      try{
        const data = JSON.stringify(loadAnalytics(), null, 2);
        const blob = new Blob([data], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = el('a',{href:url});
        a.download = 'campuscare_analytics.json';
        document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
      }catch(e){ alert('Failed to export analytics'); }
    }

    /*** Export local data quick helper ***/
    if(exportLocalDataBtn) exportLocalDataBtn.addEventListener('click', downloadAnalyticsJson);

    /*** small helpers for resource links (sidebar) ***/
    if(openMindTips) openMindTips.addEventListener('click', (e)=>{ e.preventDefault(); window.open('https://www.mayoclinic.org/healthy-lifestyle/consumer-health/in-depth/mindfulness-exercises/art-20046356','_blank'); });
    if(openYogaLink) openYogaLink.addEventListener('click', (e)=>{ e.preventDefault(); window.open('https://www.verywellfit.com/essential-yoga-poses-for-beginners-3566747','_blank'); });

    /*** record some UI interactions for analytics ***/
    // header/footer chatbot triggers already record in init when clicked
    if(openChatBtn) openChatBtn.addEventListener('click', ()=> recordEvent('chatbot_trigger','header'));
    if(openChatBtnFooter) openChatBtnFooter.addEventListener('click', ()=> recordEvent('chatbot_trigger','footer'));
    if(helpQuickBtn) helpQuickBtn.addEventListener('click', ()=> recordEvent('quick_help','header'));

    // Provide window API for debugging
    window.CampusCare = {
      openChatbot, closeChatbot, openEmergency, recordEvent, getAnalytics: loadAnalytics
    };

    // Initialize after small delay to ensure DOM ready
    document.addEventListener('DOMContentLoaded', ()=>{ setTimeout(init, 60); });

  })();
  </script>
<!-- End of file -->
<script async="" defer="" src="https://accounts.google.com/gsi/client"></script>
<script>
function loginUser(){
    let u = document.getElementById("user").value;
    let p = document.getElementById("pass").value;
    if(u === "student" && p === "12345"){
        hideLoginOverlay();
    } else {
        document.getElementById("err").style.display = "block";
    }
}
function hideLoginOverlay(){
    const box = document.getElementById("loginOverlay");
    box.style.transition = "opacity 0.6s ease";
    box.style.opacity = "0";
    setTimeout(() => { box.style.display = "none"; }, 600);
}
function handleGoogleLogin(response){
    const data = jwtDecode(response.credential);
    localStorage.setItem("campus_user", JSON.stringify(data));
    hideLoginOverlay();
}
function jwtDecode(token){
    return JSON.parse(atob(token.split('.')[1]));
}
</script>
</body>
</html>
